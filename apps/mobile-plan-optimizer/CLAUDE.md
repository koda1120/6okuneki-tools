# 携帯料金プラン最適化診断 - 開発メモ

## 2026-01-20 セッション

### 今日決めた重要な設計方針

1. **速度制限付き無制限プランの分離**
   - `DataCapacityType`に`unlimited_speed_limited`を新設
   - `Plan`型に`maxSpeed`フィールド追加（常時の最大速度Mbps）
   - 高速無制限（楽天、ahamo大盛り等）と速度制限付き無制限（マイそく等）を明確に区別

2. **スコアリングでの速度制限プラン対応**
   - ユーザーが「無制限」以外を選択 → 速度制限プランはデータスコア20点に大幅減点
   - 品質スコアも速度に応じたペナルティ（1.5Mbps制限で約35点減）
   - 警告に速度制限の明示を追加

3. **現在の月額料金入力**
   - スライダーで0円〜20,000円（100円単位）
   - クイック選択ボタン（3,000/5,000/7,000/10,000円）

### 解決した問題とその方法

| 問題 | 解決方法 |
|------|----------|
| ページ遷移時にトップに戻らない | `useDiagnosis.ts`の各ステップ遷移で`window.scrollTo(0, 0)`追加 |
| 割引額の内訳が見えない | `AppliedDiscount`を`{name, amount}`に拡張、PlanCardで金額表示 |
| クレジットカードが1枚しか選べない | `creditCard: string`を`creditCards: CreditCard[]`に変更、複数選択UI |
| 公式サイトリンクが動作しない | 50キャリア分のURL mapping追加、`<button>`を`<a>`タグに変更 |
| マイそくが常に1位になる | `unlimited_speed_limited`タイプ新設、スコアリングで大幅減点 |

### 次回やるべきこと

1. **他の速度制限プランの確認・追加**
   - マイそくプレミアム（3Mbps）、ライト（300kbps）等
   - 他キャリアの類似プラン調査

2. **節約額の表示改善**
   - 現在の月額料金との差額を結果画面で表示
   - 年間節約額の強調

3. **プランデータの精査**
   - 157プランの料金・オプション情報の最新化
   - 新プランの追加（2026年情報）

4. **UI/UX改善検討**
   - 診断結果のフィルタリング機能
   - プラン比較機能

---

## 技術スタック
- React + TypeScript + Vite + Tailwind CSS
- pnpm monorepo
- Netlify デプロイ

## デプロイ
- 本番URL: https://6niki-keitai-shindan.netlify.app/
- サイトID: 9c07565c-b7ca-424d-8298-c82095d90305
